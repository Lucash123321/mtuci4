{% include "posts/base.html" %}
{% if posts %}
    <ul class="posts">
        {% for post in posts %}
            {% if not post.is_comment %}
            <li class="post">
                <a href="{% url 'topics:posts:post_detail' topic.slug post.topic_post_id %}">{{ post.title }}</a>
                <p class="upvotes" data-post-id="{{ post.topic_post_id }}" data-type="post">Upvotes: {{ post.upvotes }}</p>
                <p class="downvotes" data-post-id="{{ post.topic_post_id }}" data-type="post">Downvotes: {{ post.downvotes }}</p>
                <form action="{% url 'topics:posts:vote_post' topic.slug post.topic_post_id 'up' %}" method="post" class="vote-form" data-post-id="{{ post.topic_post_id }}" data-type="post">
                    {% csrf_token %}
                    <button
                        type="submit"
                        class="vote-button {% if post.user_vote_type == 'up' %}selected{% endif %}"
                        data-vote-type="up">
                        Upvote
                    </button>
                </form>
                <form action="{% url 'topics:posts:vote_post' topic.slug post.topic_post_id 'down' %}" method="post" class="vote-form" data-post-id="{{ post.topic_post_id }}" data-type="post">
                    {% csrf_token %}
                    <button
                        type="submit"
                        class="vote-button {% if post.user_vote_type == 'down' %}selected{% endif %}"
                        data-vote-type="down">
                        Downvote
                    </button>
                </form>
                <p>{{ post.description }}</p>
                <small>{{ post.date }}</small>

                {% include "posts/comments.html" with comments=post.comments.all %}
                
            </li>
            {% endif %}
        {% endfor %}
    </ul>

    {% include "posts/vote.html" %}
    
{% else %}
    <p>Нет постов в данном топике.</p>
{% endif %}
